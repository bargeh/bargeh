@page "/Forum/{ForumPermalink}"
@using Forums.Api
@inject ForumsProto.ForumsProtoClient ForumsService;
@inject NotFoundListener NotFoundService;
@using Grpc.Core
@using Bargeh.Main.Wapp.Client.Infrastructure


@if(_forum is not null)
{
	<div class="cover" style="background-image: url('/img/@(_forum.Cover).webp');"></div>
	<div class="profile">
		<img src="img/@(_forum.Avatar).webp" alt="تصویر نمایه @_forum.Name">
		<h1 class="center">@_forum.Name</h1>
		<div class="index-buttons">
			<p>@_forum.Members عضو</p>
			<p>۱۳ حامی</p>
		</div>
		<p>مالک انجمن: <a>@@@_forum.Owner</a></p>
		<p>ناظران انجمن: <a>@@user10</a>، <a>@@user02</a>، <a>@@user03</a></p>
		<p class="center-justify">@_forum.Description</p>
		<div class="index-buttons">
			<button type="button" class="button-filled">
				<img src="img/UserPlus.svg" alt="دنبال کردن">
				<p>دنبال کردن</p>
			</button>
			<button type="button" class="button-gold" onclick="alert('هه هه، از طرف مالک انجمن ازت تشکر می‌کنم، ولی فعلا باید صبر کنی تا برنامه‌نویسی برگه تکمیل شه 😅')">
				<img src="img/Support.svg" alt="حمایت">
				<p>حمایت از انجمن</p>
			</button>
		</div>
	</div>

	<div class="footer-info">
		<h2>گفت و گوهای سنجاق شده‌ی @_forum.Name</h2>
		<div class="shadow-box secondary-search-bar footer-links">
			<img src="img/Search.svg" alt="علامت ذره‌بین" class="search-icon">
			<input type="text" class="search-input" placeholder="جست و جو در گفت و گوهای @_forum.Name...">
		</div>
	</div>

	<div class="forums-list">
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
	</div>

	<div class="footer-info">
		<h2>همه‌ی گفت و گو‌های @_forum.Name</h2>
		<div class="shadow-box secondary-search-bar footer-links">
			<img src="img/Search.svg" alt="علامت ذره‌بین" class="search-icon">
			<input type="text" class="search-input" placeholder="جست و جو در گفت و گوهای @_forum.Name...">
		</div>
	</div>

	<div class="forums-list">
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
		<div class="topic">
			<div>
				<strong>بهترین سایت آموزش برنامه‌نویسی</strong> در @_forum.Name
				<p class="topic-description">
					۳۲
					<img src="img/ChatSingle.svg" alt="گفته‌ها"
						 class="topic-chat">بچه‌ها
					واسه
					شروع برنامه‌نویسی چه سایتی خوبه واقعا؟ خیلی دوره‌ها رو دیدم ولی واقعا آشغال بودن
				</p>
			</div>
		</div>
	</div>

	<a class="button-primary">
		<img src="img/More.svg" alt="بیشتر">
		<p>نمایش بیشتر</p>
	</a>
}
else
{
	<Loading/>
}

@code {

	[Parameter]
	public string ForumPermalink { get; init; } = null!;

	private ForumReply? _forum;

	protected override async Task OnInitializedAsync()
	{
		try
		{
			_forum = await ForumsService.GetForumByPermalinkAsync(new()
			{
				Permalink = ForumPermalink
			});
		}
		catch(RpcException exception)
		{
			// ReSharper disable once InvertIf
			if(exception.StatusCode == StatusCode.NotFound)
			{
				NotFoundService.NotifyNotFound();
				return;
			}

			throw;
		}
	}

}